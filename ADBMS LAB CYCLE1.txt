LAB CYCLE – 1
DDL Commands
1. Create the database named HR and the above tables in the HR database; include the Primary
Key Constraint, Referential Integrity Constraints as shown in the schema diagram

create table regions(region_id number(5) primary key,region_name varchar(25));
create table countries(country_id char(5) primary key,country_name varchar(40),region_id
number(5),foreign key(region_id) references regions(region_id));
create table locations(location_id number(5) primary key,street_address varchar(25),postal_code
varchar(12),city varchar(30),state_province varchar(12),country_id char(5),foreign key(country_id)
references countries(country_id));
create table departments(department_id number(3) primary key,department_name varchar(30),manager_id
number(5),location_id number(3),foreign key(location_id) references locations(location_id));
create table job_grades(grade_level varchar(2) primary key,lowest_sal number(5),highest_sal number(5));
create table jobs(job_id varchar(10) primary key,job_title varchar(35),min_salary number(10),max_salary
number(10));
create table employees(employee_id number(3) primary key,first_name varchar(20),last_name
varchar(25),email varchar(25),phone_number varchar(20),hire_date date,job_id varchar(10),salary
number(10),commission_pct number(5),manager_id number(3),department_id number(3),foreign
key(job_id) references jobs(job_id),foreign key(department_id) references departments(department_id));
create table job_history(employee_id number(3),start_date date,end_date date,job_id
varchar(10),department_id number(3),primary key(employee_id,start_date),foreign key(employee_id)
references employees(employee_id),foreign key(job_id) references jobs(job_id),foreign key(department_id)
references departments(department_id));
Table created.
Table created.
Table created.
Table created.
Table created.
Table created.
Table created.
Table created.

2. Add a field Circle to the table regions with the default value set to ‘East’ and display its modified
schema.
alter table regions add circle varchar(3);
alter table regions modify circle varchar(4) default 'East';
DESC regions;
Table altered. Table altered.
TABLE REGIONS
Column

Null?

Type

REGION_ID

NOT NULL

NUMBER(5,0)

REGION_NAME

-

VARCHAR2(25)

CIRCLE

-

VARCHAR2(4)

3. Set a constraint to the SALARY field in the employees table that accepts only amount greater than zero

alter table employees modify salary number(10) check(salary>0);
DESC employees;
Table altered.
TABLE EMPLOYEES
Column

Null?

Type

EMPLOYEE_ID

NOT NULL

NUMBER(3,0)

FIRST_NAME

-

VARCHAR2(20)

LAST_NAME

-

VARCHAR2(25)

EMAIL

-

VARCHAR2(25)

PHONE_NUMBER

-

VARCHAR2(20)

HIRE_DATE

-

DATE

JOB_ID

-

VARCHAR2(10)

SALARY

-

NUMBER(10,0)

COMMISSION_PCT

-

NUMBER(5,0)

MANAGER_ID

-

NUMBER(3,0)

DEPARTMENT_ID

-

NUMBER(3,0)

4. Modify the table countries by changing the width of the field COUNTRY_NAME to 30.

alter table countries modify country_name varchar(30);
DESC countries;
Table altered.
TABLE COUNTRIES

Column

Null?

Type

COUNTRY_ID

NOT NULL

CHAR(5)

COUNTRY_NAME

-

VARCHAR2(30)

REGION_ID

-

NUMBER(5,0)

5. Make the PHONE_NUMBER field in employees unique and check the EMAIL is a valid gmail account

alter table employees modify phone_number varchar(20) unique;
alter table employees modify email varchar(25) check(email like '_%@%.%');

Table altered.
Table altered.

6. Drop the column Circle from the regions table

alter table regions drop column circle;
desc regions;
Table altered.
TABLE REGIONS

Column

Null?

Type

REGION_ID

NOT NULL

NUMBER(5,0)

REGION_NAME

-

VARCHAR2(25)

7. Create a view for employees who get commission by hiding salary information. Display the contents of
created view.

create view emps_view as select
employee_id,first_name,last_name,email,phone_number,hire_date,job_id,commission_pct,manager_id,depa
rtment_id from employees where commission_pct!=0;
View created.

II. DML Commands:

8. Insert details in the above tables using the values given below

insert into regions values(1,'zone1');
insert into regions values(2,'zone2');
insert into regions values(3,'zone3');
insert into regions values(4,'zone4');
select * from regions;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
REGION_ID

REGION_NAME

1

zone1

2

zone2

3

zone3

4

zone4

insert into countries values('AU','AUSTRALIA',3);
insert into countries values('CA','CANADA',2);
insert into countries values('CN','CHINA',3);
insert into countries values('IN','INDIA',1);
insert into countries values('US','AMERICA',2);
insert into countries values('JP','JAPAN',4);
insert into countries values('IT','ITALY',1);
insert into countries values('MX','MEXICO',2);
insert into countries values('UK','UNITED KINGDOM',1);
select *from countries;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
COUNTRY_ID

COUNTRY_NAME

REGION_ID

AU

AUSTRALIA

3

CA

CANADA

2

CN

CHINA

3

IN

INDIA

1

US

AMERICA

2

JP

JAPAN

4

IT

ITALY

1

MX

MEXICO

2

UK

UNITED KINGDOM

1

alter table locations modify STATE_PROVINCE varchar(20);
Table altered.
insert into locations values(1000,'147 BOX WOOD ST.','15643','ROMA','NIL','IT');
insert into locations values(1200,'12/98 VICTORIA RD.','1657','TORONTO','ONTARIO','CA');
insert into locations values(1100,'234 CHURCH RD.','23416','TOKYO','TOKYO PREFECTURE','JP');

insert into locations values(1300,'820 ARTHUR RD.','NIL','LONDON','NIL','UK');
insert into locations values(1400,'2004 CAROL RD','7645','SEETTLE','WASHINGTON','US');
insert into locations values(1500,'12 CHESTER RD.','8732','WHITEHORSE','YUKON','CA');
insert into locations values(1600,'MARIANO 9991','11932','MEXICO CITY','DISTRITO
FEDERAL','MX');
insert into locations values(1700,'CROWN HILL','678','BROWNSWICK','NEW JERSEY','US');
insert into locations values(1800,'123 MARINA RD.','123456','MUMBAI','MAHARASHTRA','IN');
insert into locations values(1900,'29 SEA LANE','3456','SYDNEY','NEW SOUTH WALES','AU');
select * from locations;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
LOCATION
_ID

STREET_ADDR
ESS

POSTAL_CO
DE

CITY

STATE_PROVI
NCE

COUNTRY
_ID

1000

147 BOX WOOD
ST.

15643

ROMA

NIL

IT

1200

12/98 VICTORIA
RD.

1657

TORONTO

ONTARIO

CA

1100

234 CHURCH
RD.

23416

TOKYO

TOKYO
PREFECTURE

JP

1300

820 ARTHUR
RD.

NIL

LONDON

NIL

UK

1400

2004 CAROL RD

7645

SEETTLE

WASHINGTON

US

1500

12 CHESTER
RD.

8732

WHITEHOR
SE

YUKON

CA

1600

MARIANO 9991

11932

MEXICO
CITY

DISTRITO
FEDERAL

MX

1700

CROWN HILL

678

BROWNSWI
CK

NEW JERSEY

US

1800

123 MARINA
RD.

123456

MUMBAI

MAHARASHTR
A

IN

1900

29 SEA LANE

3456

SYDNEY

NEW SOUTH
WALES

AU

insert into job_grades values('A',1000,2999);
insert into job_grades values('B',3000,5999);
insert into job_grades values('C',6000,9999);
insert into job_grades values('D',10000,14999);
insert into job_grades values('E',15000,24999);
insert into job_grades values('F',25000,40000);
select *from job_grades;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
GRADE_LEVEL LOWEST_SAL

HIGHEST_SAL

A

1000

2999

B

3000

5999

C

6000

9999

D

10000

14999

E

15000

24999

F

25000

40000

insert into jobs values('AD_PRES','PRESIDENT',20080,40000);
insert into jobs values('SA_REP','SALES REPRESENTATIVES',6000,12008);
insert into jobs values('AD_VP','ADMN.VICE PRESIDENT',15000,30000);
insert into jobs values('IT_PROG','PROGRAMMER',6000,11000);
insert into jobs values('SA_MAN','SALES MANAGER',10000,20080);
insert into jobs values('CLERK','CLERK',2500,7000);
insert into jobs values('HR_REP','HR REPRESENTATIVE',5000,10000);
insert into jobs values('ACCOUNTANT','ACCOUNTANT',4200,9000);
insert into jobs values('FIN_MAN','FINANCE MANAGER',8200,16000);
select *from jobs;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
JOB_ID

JOB_TITLE

MIN_SALARY

MAX_SALARY

AD_PRES

PRESIDENT

20080

40000

SA_REP

SALES REPRESENTATIVES

6000

12008

AD_VP

ADMN.VICE PRESIDENT

15000

30000

IT_PROG

PROGRAMMER

6000

11000

SA_MAN

SALES MANAGER

10000

20080

CLERK

CLERK

2500

7000

HR_REP

HR REPRESENTATIVE

5000

10000

ACCOUNTANT

ACCOUNTANT

4200

9000

FIN_MAN

FINANCE MANAGER

8200

16000

alter table departments modify location_id number(5);
Table altered.
insert into departments values(10,'administration',200,1700);
insert into departments values(20,'marketing',201,1900);
insert into departments values(30,'purchasing',114,1700);
insert into departments values(40,'human resource',203,1000);
insert into departments values(50,'finance',108,1200);
insert into departments values(60,'accounting',205,1800);
insert into departments values(70,'shipping',121,1500);
insert into departments values(80,'sales',145,1900);
insert into departments values(90,'manufacturing',0,1700);
insert into departments values(100,'construction',0,1300);
insert into departments values(110,'it',103,1400);
insert into departments values(120,'recruiting',0,1600);
insert into departments values(130,'payroll',100,1800);
select *from departments;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted.
DEPARTMENT_ID

DEPARTMENT_NAME

MANAGER_ID

LOCATION_ID

10

administration

200

1700

20

marketing

201

1900

30

purchasing

114

1700

40

human resource

203

1000

50

finance

108

1200

60

accounting

205

1800

70

shipping

121

1500

80

sales

145

1900

90

manufacturing

0

1700

100

construction

0

1300

110

it

103

1400

120

recruiting

0

1600

130

payroll

100

1800

insert into employees values(100,'STEVEN','KING','SKING@GMAIL.COM',8182345210,'17-JUN2003','AD_PRES',28000,0,0,90);
insert into employees values(101,'NEENA','KOCHHAR','NKOCHHAR@GMAIL.COM',9897561234,'21SEP-2005','AD_VP',22000,0,100,130);
insert into employees values(102,'LEX','DE HAAN','LDEHAAN@GMAIL.COM',9554667890,'13-JAN2001','AD_VP',30000,0,100,130);
insert into employees
values(103,'ALEXANDER','HUNOLD','AHUNOLD@GMAIL.COM',8678905431,'03-JAN2006','IT_PROG',10500,0,103,110);
insert into employees values(104,'DAVID','AUSTIN','DAUSTIN@GMAIL.COM',9495235678,'10-MAY2007','IT_PROG',10000,0,103,110);
insert into employees values(105,'DIANA','LORENTZ','DLORENTZ@GMAIL.COM',9876542310,'20NOV-2009','IT_PROG',8000,0,103,110);
insert into employees values(106,'NANCY','GREENBERG','NGREEN@GMAIL.COM',8769054324,'30OCT-2010','IT_PROG',7000,0,103,110);
insert into employees values(107,'JOHN','RUSSEL','JRUSSEL@GMAIL.COM',6778653490,'09-OCT2004','SA_MAN',14000,0.4,201,20);
insert into employees values(108,'PETER','TUKER','PTUKER@GMAIL.COM',9067865423,'30-JAN2005','SA_MAN',10000,0.3,201,20);
insert into employees values(109,'NEIL','JOSEPH','NJOSEPH@GMAIL.COM',7689054321,'31-MAR2006','SA_MAN',12000,0.2,201,20);
insert into employees values(110,'JANETTE','KING','JKING@GMAIL.COM',9809897645,'04-MAR2006','SA_REP',10000,0.35,145,80);
insert into employees values(111,'WILLIAM','JOHN','WJOHN@GMAIL.COM',7682315672,'23-NOV2008','CLERK',6000,0,200,10);
insert into employees values(112,'ANITTA','BAKER','ABAKER@GMAIL.COM',2345678910,'15-SEP2010','HR_REP',9000,0,203,40);
insert into employees values(113,'NANDITA','MOHAN','NMOHAN@GMAIL.COM',94445634213,'20JUL-2014','ACCOUNTANT',8000,0,205,60);
insert into employees values(114,'SUSAN','VARKEY','SVARKEY@GMAIL.COM',8976054321,'14-DEC2004','FIN_MAN',15000,0,108,50);
select *from employees;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.

EMPL
OYEE
_ID

FIRS
T_N
AME

LAS
T_N
AME

PHON
E_NU
MBER

HIR
E_D
ATE

JOB_
ID

SA
LA
RY

COMM
ISSION
_PCT

MAN
AGE
R_ID

DEPA
RTME
NT_ID

100

STEV
EN

KIN
G

SKING@G
MAIL.CO
M

818234
5210

17JUN03

AD_P
RES

280
00

0

0

90

101

NEE
NA

KOC
HHA
R

NKOCHH
AR@GMA
IL.COM

989756
1234

21SEP05

AD_V
P

220
00

0

100

130

LEX

DE
HAA
N

LDEHAAN
@GMAIL.
COM

955466
7890

13JAN01

102

AD_V
P

300
00

0

100

130

103

ALE
XAN
DER

HUN
OLD

AHUNOL
D@GMAI
L.COM

867890
5431

03JAN06

IT_PR
OG

105
00

0

103

110

104

DAVI
D

AUS
TIN

DAUSTIN
@GMAIL.
COM

949523
5678

10MA
Y-07

IT_PR
OG

100
00

0

103

110

105

DIAN
A

LOR
ENT
Z

DLORENT
Z@GMAIL
.COM

987654
2310

20NOV
-09

IT_PR
OG

800
0

0

103

110

106

NAN
CY

GRE
ENB
ERG

NGREEN
@GMAIL.
COM

876905
4324

30OCT
-10

IT_PR
OG

700
0

0

103

110

107

JOHN

RUS
SEL

JRUSSEL
@GMAIL.
COM

677865
3490

09OCT
-04

SA_M
AN

140
00

0

201

20

108

PETE
R

TUK
ER

PTUKER@
GMAIL.C
OM

906786
5423

30JAN05

SA_M
AN

100
00

0

201

20

109

NEIL

JOSE
PH

NJOSEPH
@GMAIL.
COM

768905
4321

31MAR
-06

SA_M
AN

120
00

0

201

20

110

JANE
TTE

KIN
G

JKING@G
MAIL.CO
M

980989
7645

04MAR
-06

SA_R
EP

100
00

0

145

80

111

WILL
IAM

JOH
N

WJOHN@
GMAIL.C
OM

768231
5672

23NOV
-08

CLER
K

600
0

0

200

10

112

ANIT
TA

BAK
ER

ABAKER
@GMAIL.
COM

234567
8910

15SEP10

HR_R
EP

900
0

0

203

40

113

NAN
DITA

MOH
AN

NMOHAN
@GMAIL.
COM

944456
34213

20JUL14

ACC
OUN
TANT

800
0

0

205

60

114

SUSA
N

VAR
KEY

SVARKEY
@GMAIL.
COM

897605
4321

14DEC
-04

FIN_
MAN

150
00

0

108

50

EMAIL

insert into job_history values(102,'13-JAN-2001','24-JUL-2006','IT_PROG',110);
insert into job_history values(101,'21-SEP-1997','27-OCT-2001','ACCOUNTANT',60);
insert into job_history values(101,'28-OCT-2001','15-MAR-2005','FIN_MAN',50);
insert into job_history values(112,'17-FEB-2004','19-DEC-2007','HR_REP',40);
insert into job_history values(114,'24-MAR-2006','31-DEC-2007','CLERK',10);
insert into job_history values(112,'01-JAN-2007','31-DEC-2007','AD_VP',130);
insert into job_history values(109,'24-MAR-2006','31-DEC-2006','SA_MAN',20);
insert into job_history values(105,'01-JUL-2002','31-DEC-2005','SA_REP',80);
insert into job_history values(105,'17-FEB-2006','19-DEC-2007','IT_PROG',110);
select * from job_history;
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
1 row(s) inserted. 1 row(s) inserted. 1 row(s) inserted.
EMPLOYEE_ID

START_DATE END_DATE

JOB_ID

DEPARTMENT_ID

102

13-JAN-01

24-JUL-06

IT_PROG

110

101

21-SEP-97

27-OCT-01

ACCOUNTANT

60

101

28-OCT-01

15-MAR-05

FIN_MAN

50

112

17-FEB-04

19-DEC-07

HR_REP

40

114

24-MAR-06

31-DEC-07

CLERK

10

112

01-JAN-07

31-DEC-07

AD_VP

130

109

24-MAR-06

31-DEC-06

SA_MAN

20

105

01-JUL-02

31-DEC-05

SA_REP

80

105

17-FEB-06

19-DEC-07

IT_PROG

110

9. Update the street_Address of Roma city to 115 Monte Carlo Rd. in locations table.
update locations set street_address='115 MONTE CARLO RD.' where city='ROMA';
select *from locations;
1 row(s) updated.
LOCATION
_ID

STREET_ADDR
ESS

POSTAL_CO
DE

CITY

STATE_PROVI
NCE

COUNTRY
_ID

1000

115 MONTE
CARLO RD.

15643

ROMA

NIL

IT

1200

12/98 VICTORIA
RD.

1657

TORONTO

ONTARIO

CA

1100

234 CHURCH
RD.

23416

TOKYO

TOKYO
PREFECTURE

JP

1300

820 ARTHUR
RD.

NIL

LONDON

NIL

UK

1400

2004 CAROL RD

7645

SEETTLE

WASHINGTON

US

1500

12 CHESTER
RD.

8732

WHITEHOR
SE

YUKON

CA

1600

MARIANO 9991

11932

MEXICO
CITY

DISTRITO
FEDERAL

MX

1700

CROWN HILL

678

BROWNSWI
CK

NEW JERSEY

US

1800

123 MARINA
RD.

123456

MUMBAI

MAHARASHTR
A

IN

1900

29 SEA LANE

3456

SYDNEY

NEW SOUTH
WALES

AU

10. Give a 15% increment in salary for all employees.
update employees set salary=salary+salary*0.15;
select * from employees;
15 row(s) updated.
EMPL
OYEE
_ID

FIRS
T_N
AME

LAS
T_N
AME

PHON
E_NU
MBER

HIR
E_D
ATE

JOB_
ID

SA
LA
RY

COMM
ISSION
_PCT

MAN
AGE
R_ID

DEPA
RTME
NT_ID

100

STEV
EN

KIN
G

SKING@G
MAIL.CO
M

818234
5210

17JUN03

AD_P
RES

322
00

0

0

90

101

NEE
NA

KOC
HHA
R

NKOCHH
AR@GMA
IL.COM

989756
1234

21SEP05

AD_V
P

253
00

0

100

130

102

LEX

DE
HAA
N

LDEHAAN
@GMAIL.
COM

955466
7890

13JAN01

AD_V
P

345
00

0

100

130

103

ALE
XAN
DER

HUN
OLD

AHUNOL
D@GMAI
L.COM

867890
5431

03JAN06

IT_PR
OG

120
75

0

103

110

104

DAVI
D

AUS
TIN

DAUSTIN
@GMAIL.
COM

949523
5678

10MA
Y-07

IT_PR
OG

115
00

0

103

110

105

DIAN
A

LOR
ENT
Z

DLORENT
Z@GMAIL
.COM

987654
2310

20NOV
-09

IT_PR
OG

920
0

0

103

110

106

NAN
CY

GRE
ENB
ERG

NGREEN
@GMAIL.
COM

876905
4324

30OCT
-10

IT_PR
OG

805
0

0

103

110

107

JOHN

RUS
SEL

JRUSSEL
@GMAIL.
COM

677865
3490

09OCT
-04

SA_M
AN

161
00

0

201

20

108

PETE
R

TUK
ER

PTUKER@
GMAIL.C
OM

906786
5423

30JAN05

SA_M
AN

115
00

0

201

20

EMAIL

109

NEIL

JOSE
PH

NJOSEPH
@GMAIL.
COM

768905
4321

31MAR
-06

SA_M
AN

138
00

0

201

20

110

JANE
TTE

KIN
G

JKING@G
MAIL.CO
M

980989
7645

04MAR
-06

SA_R
EP

115
00

0

145

80

111

WILL
IAM

JOH
N

WJOHN@
GMAIL.C
OM

768231
5672

23NOV
-08

CLER
K

690
0

0

200

10

112

ANIT
TA

BAK
ER

ABAKER
@GMAIL.
COM

234567
8910

15SEP10

HR_R
EP

103
50

0

203

40

113

NAN
DITA

MOH
AN

NMOHAN
@GMAIL.
COM

944456
34213

20JUL14

ACC
OUN
TANT

920
0

0

205

60

114

SUSA
N

VAR
KEY

SVARKEY
@GMAIL.
COM

897605
4321

14DEC
-04

FIN_
MAN

172
50

0

108

50

11. Add a new employee in the ‘Recruiting‘ department as clerk and set joining date as today’s date.
insert into employees
values(115,'JAIDEN','ALEX','JAI@GMAIL.COM',9496131093,SYSDATE,'CLERK',2500,0,0,120);
select * from employees;
1 row(s) inserted.
EMPL
OYEE
_ID

FIRS
T_N
AME

LAS
T_N
AME

EMAIL

PHON
E_NU
MBER

HIR
E_D
ATE

JOB_
ID

SA
LA
RY

COMM
ISSION
_PCT

MAN
AGE
R_ID

DEPA
RTME
NT_ID

115

JAID
EN

ALE
X

JAI@GMA
IL.COM

949613
1093

14AUG
-21

CLER
K

250
0

0

0

120

100

STEV
EN

KIN
G

SKING@G
MAIL.CO
M

818234
5210

17JUN03

AD_P
RES

322
00

0

0

90

101

NEE
NA

KOC
HHA
R

NKOCHH
AR@GMA
IL.COM

989756
1234

21SEP05

AD_V
P

253
00

0

100

130

102

LEX

DE
HAA
N

LDEHAAN
@GMAIL.
COM

955466
7890

13JAN01

AD_V
P

345
00

0

100

130

103

ALE
XAN
DER

HUN
OLD

AHUNOL
D@GMAI
L.COM

867890
5431

03JAN06

IT_PR
OG

120
75

0

103

110

104

DAVI
D

AUS
TIN

DAUSTIN
@GMAIL.
COM

949523
5678

10MA
Y-07

IT_PR
OG

115
00

0

103

110

105

DIAN
A

LOR
ENT
Z

DLORENT
Z@GMAIL
.COM

987654
2310

20NOV
-09

IT_PR
OG

920
0

0

103

110

106

NAN
CY

GRE
ENB
ERG

NGREEN
@GMAIL.
COM

876905
4324

30OCT
-10

IT_PR
OG

805
0

0

103

110

107

JOHN

RUS
SEL

JRUSSEL
@GMAIL.
COM

677865
3490

09OCT
-04

SA_M
AN

161
00

0

201

20

108

PETE
R

TUK
ER

PTUKER@
GMAIL.C
OM

906786
5423

30JAN05

SA_M
AN

115
00

0

201

20

109

NEIL

JOSE
PH

NJOSEPH
@GMAIL.
COM

768905
4321

31MAR
-06

SA_M
AN

138
00

0

201

20

110

JANE
TTE

KIN
G

JKING@G
MAIL.CO
M

980989
7645

04MAR
-06

SA_R
EP

115
00

0

145

80

111

WILL
IAM

JOH
N

WJOHN@
GMAIL.C
OM

768231
5672

23NOV
-08

CLER
K

690
0

0

200

10

112

ANIT
TA

BAK
ER

ABAKER
@GMAIL.
COM

234567
8910

15SEP10

HR_R
EP

103
50

0

203

40

113

NAN
DITA

MOH
AN

NMOHAN
@GMAIL.
COM

944456
34213

20JUL14

ACC
OUN
TANT

920
0

0

205

60

114

SUSA
N

VAR
KEY

SVARKEY
@GMAIL.
COM

897605
4321

14DEC
-04

FIN_
MAN

172
50

0

108

50

commit;
Statement processed.
12. Delete grade_level value ‘F’ in table job_grades and conform the deletion by verifying the remaining rows
of the table

delete from job_grades where grade_level='F';
select * from job_grades;
1 row(s) deleted.
GRADE_LEVEL LOWEST_SAL

HIGHEST_SAL

A

1000

2999

B

3000

5999

C

6000

9999

D

10000

14999

E

15000

24999

III. TCL Commands:
13.Undo the previous delete operation.

rollback;
Statement processed.
14. Save all the transactions to the database.
commit;
Statement processed.

15. .Grant the privilege to read and delete from the employees table to the User U1.
GRANT UPDATE, TRIGGER ON TABLE employees TO UI;

Statement processed.

16. .Revoke the delete privilege from U1.
REVOKE DELETE ON employees FROM UI;

Statement processed.

IV. Accessing database (SELECT, Filtering using WHERE, HAVING, GROUP BY,
ORDER BY Clauses, Subquery):
17. Display countries along with their regional code.

SELECT country_name,region_id from countries;
SELECT a.country_name,b.region_name from countries a, regions b where a.region_id=b.region_id;
COUNTRY_NAME

REGION_ID

AUSTRALIA

3

CANADA

2

CHINA

3

INDIA

1

AMERICA

2

JAPAN

4

ITALY

1

MEXICO

2

UNITED KINGDOM

1

COUNTRY_NAME

REGION_NAME

AUSTRALIA

zone3

CANADA

zone2

CHINA

zone3

INDIA

zone1

AMERICA

zone2

JAPAN

zone4

ITALY

zone1

MEXICO

zone2

UNITED KINGDOM

zone1

18. List department ID without any repeats from employees table.
SELECT DISTINCT department_id from employees;
DEPARTMENT_ID
50
110
40
90
10
120
130
20
60

80

19. . List the official address and names of all employees in Marketing Department
SELECT first_name,last_name,street_address from employees,locations where location_id in (select
location_id from departments where department_name='marketing')
and department_id in (select department_id from departments where department_name='marketing');
FIRST_NAME

LAST_NAME

STREET_ADDRESS

JOHN

RUSSEL

29 SEA LANE

PETER

TUKER

29 SEA LANE

NEIL

JOSEPH

29 SEA LANE

20. Display first and last name in a single heading Name, salary, department ID for those employees whose
department is located in the city Mumbai.

SELECT department_id,CONCAT(first_name,last_name) AS Name,salary from employees where
department_id in
(select department_id from departments where location_id in (select location_id from locations where
city='MUMBAI'));
DEPARTMENT_ID

NAME

SALARY

130

NEENAKOCHHAR

50888

130

LEXDE HAAN

69392

60

NANDITAMOHAN

18505

21. List the total salary spent for each department
SELECT DISTINCT department_id,sum(salary) OVER(PARTITION BY department_id) Salary from
employees;
DEPARTMENT_ID

SALARY

40

20817

50

34697

130

120280

20

83272

90

64767

10

13878

110

82116

60

18505

120

5028

80

23131

22. List the names of employees in Marketing having salary greater than maximum salary of employees in IT
department

SELECT *FROM employees WHERE salary IN (SELECT salary FROM employees WHERE
department_id IN (SELECT d.department_id FROM departments d WHERE d.department_name =
'marketing')) and salary > (SELECT max(salary) FROM employees WHERE department_id IN (SELECT
d.department_id FROM departments d WHERE d.department_name = 'it'));
EMPL
OYEE
_ID

FIRS
T_NA
ME

LAS
T_N
AME

107

JOHN

RUSS
EL

109

NEIL

JOSE
PH

PHON
E_NU
MBER

HIR
E_D
ATE

JO
B_I
D

SA
LA
RY

COMMI
SSION_
PCT

MAN
AGE
R_ID

DEPAR
TMEN
T_ID

JRUSSEL
@GMAIL.
COM

6778653
490

09OCT04

SA
_M
AN

323
83

0

201

20

NJOSEPH
@GMAIL.
COM

7689054
321

31MAR
-06

SA
_M
AN

277
58

0

201

20

EMAIL

23. Display country names in upper case and in descending order along with their codes.
SELECT country_id,upper(country_name) from countries order by country_name desc;
COUNTRY_ID

UPPER(COUNTRY_NAME)

UK

UNITED KINGDOM

MX

MEXICO

JP

JAPAN

IT

ITALY

IN

INDIA

CN

CHINA

CA

CANADA

AU

AUSTRALIA

US

AMERICA

24. Display the full name (first and last), hire date, salary, and department number for those employees whose
first name does not containing the letter ‘S’ and make the result set in ascending order by department number.

SELECT CONCAT(first_name,last_name) AS Name,hire_date,salary,department_id from employees where
first_name not LIKE '%S%' order by department_id asc;

NAME

HIRE_DATE

SALARY

DEPARTMENT_ID

WILLIAMJOHN

23-NOV-08

13878

10

JOHNRUSSEL

09-OCT-04

32383

20

NEILJOSEPH

31-MAR-06

27758

20

PETERTUKER

30-JAN-05

23131

20

ANITTABAKER

15-SEP-10

20817

40

NANDITAMOHAN

20-JUL-14

18505

60

JANETTEKING

04-MAR-06

23131

80

DIANALORENTZ

20-NOV-09

18505

110

DAVIDAUSTIN

10-MAY-07

23131

110

ALEXANDERHUNOLD

03-JAN-06

24287

110

NANCYGREENBERG

30-OCT-10

16193

110

JAIDENALEX

14-AUG-21

5028

120

LEXDE HAAN

13-JAN-01

69392

130

NEENAKOCHHAR

21-SEP-05

50888

130

25. Identify all employees who work in departments located in the United States.
SELECT first_name from employees where department_id in (select department_id from departments
where location_id in (select location_id from locations where country_id in (select country_id from
countries where country_name= 'AMERICA')));
FIRST_NAME
STEVEN
ALEXANDER
DAVID
DIANA
NANCY
WILLIAM

26. Display the name (first name and last name) for those employees who gets more salary than the employee
whose id is 112.

SELECT CONCAT(first_name,last_name) AS Name,salary from employees where salary > (select salary
from employees where employee_id='112');

NAME

SALARY

STEVENKING

64767

NEENAKOCHHAR

50888

LEXDE HAAN

69392

ALEXANDERHUNOLD

24287

DAVIDAUSTIN

23131

JOHNRUSSEL

32383

PETERTUKER

23131

NEILJOSEPH

27758

JANETTEKING

23131

SUSANVARKEY

34697

V. Optimizing databases (Join, Aggregate & Set operations, Other operators like
arithmetic, special etc):
27. Use inner join to display the name, department number, and department name for each employee

SELECT
employees.first_name,employees.last_name,departments.department_id,departments.department_name
FROM employees INNER JOIN departments ON employees.department_id = departments.department_id;
FIRST_NAME

LAST_NAME

DEPARTMENT_ID

DEPARTMENT_NAME

STEVEN

KING

90

manufacturing

NEENA

KOCHHAR

130

payroll

LEX

DE HAAN

130

payroll

ALEXANDER

HUNOLD

110

it

DAVID

AUSTIN

110

it

DIANA

LORENTZ

110

it

NANCY

GREENBERG

110

it

JOHN

RUSSEL

20

marketing

PETER

TUKER

20

marketing

NEIL

JOSEPH

20

marketing

JANETTE

KING

80

sales

WILLIAM

JOHN

10

administration

ANITTA

BAKER

40

human resource

NANDITA

MOHAN

60

accounting

SUSAN

VARKEY

50

finance

JAIDEN

ALEX

120

recruiting

28. List employees who have no job history details using left outer join.
Select employee_name from employees left outer join departments where employee_id is NULL
NULL

29. List department details which have currently no employees using right outer join.
Select department_id,department_id from employees right outer join departments where employee_id is
NULL
NULL
30. List all employees who are working in Marketing or Human Resource Department.
SELECT first_name,last_name from employees where department_id in (select department_id from
departments where department_name in ('marketing','human resource'));
FIRST_NAME

LAST_NAME

JOHN

RUSSEL

PETER

TUKER

NEIL

JOSEPH

ANITTA

BAKER

31. List the details of employee who draw the highest salary
SELECT * from employees where salary = ( select max(salary) from employees);
EMPL
OYEE
_ID

102

FIRS
T_NA
ME

LAST
_NA
ME

EMAIL

LEX

DE
HAA
N

LDEHAAN
@GMAIL.
COM

PHONE
_NUMB
ER

HIRE
_DA
TE

JO
B_
ID

SA
LA
RY

COMMI
SSION_
PCT

MAN
AGER
_ID

DEPAR
TMENT
_ID

9554667
890

13JAN01

AD
_V
P

693
92

0

100

130

32. Find the average salary of employees who joined after 2009.
SELECT avg(salary) FROM employees WHERE hire_date>('01-JAN-09');
AVG(SALARY)
15809.6
33. . Count total number of employees in department with ID 20.
SELECT COUNT(department_id)FROM employees WHERE department_id='20';

COUNT(DEPARTMENT_ID)
3

34. . Find out the person with lowest salary in IT department
SELECT * from employees where salary = ( select min(salary) from employees where department_id in
(select department_id from departments where department_name='it'));
EMPL
OYEE
_ID

FIRS
T_NA
ME

LAST
_NA
ME

EMAIL

106

NAN
CY

GRE
ENB
ERG

NGREEN
@GMAIL.
COM

PHONE
_NUMB
ER

HIRE
_DA
TE

JOB
_ID

8769054
324

30OCT10

IT_
PR
OG

SA
LA
RY

COMMI
SSION_
PCT

MAN
AGER
_ID

DEPAR
TMENT
_ID

161
93

0

103

110

35. List all employees who joined in the period 2003-2006 and 2009-2011.
SELECT first_name FROM employees WHERE hire_date BETWEEN ('01-JAN-2003') AND ('12-DEC2011') AND hire_date NOT BETWEEN ('01-JAN-2007') AND ('12-DEC-2008');
FIRST_NAME
STEVEN
NEENA
ALEXANDER
DIANA
NANCY
JOHN
PETER
NEIL
JANETTE
ANITTA
SUSAN

36. List all employees along with their salary excluding IT programmers.
SELECT * FROM Employees WHERE department_id not in (select department_id from departments
WHERE department_name='it');

EMPL
OYEE
_ID

FIRS
T_N
AME

LAS
T_N
AME

PHON
E_NU
MBER

HIR
E_D
ATE

JOB_I
D

SA
LA
RY

COMMI
SSION_
PCT

MAN
AGE
R_ID

DEPAR
TMEN
T_ID

114

SUS
AN

VAR
KEY

SVARKEY
@GMAIL.
COM

897605
4321

14DEC
-04

FIN_
MAN

346
97

0

108

50

112

ANIT
TA

BAK
ER

ABAKER@
GMAIL.CO
M

234567
8910

15SEP10

HR_R
EP

208
17

0

203

40

100

STEV
EN

KIN
G

SKING@G
MAIL.CO
M

818234
5210

17JUN03

AD_P
RES

647
67

0

0

90

111

WILL
IAM

JOH
N

WJOHN@
GMAIL.CO
M

768231
5672

23NOV
-08

CLER
K

138
78

0

200

10

115

JAID
EN

ALE
X

JAI@GMAI
L.COM

949613
1093

14AUG
-21

CLER
K

502
8

0

0

120

NEE
NA

KOC
HHA
R

NKOCHHA
R@GMAIL
.COM

989756
1234

21SEP05

101

AD_V
P

508
88

0

100

130

102

LEX

DE
HAA
N

LDEHAAN
@GMAIL.
COM

955466
7890

13JAN01

AD_V
P

693
92

0

100

130

107

JOH
N

RUS
SEL

JRUSSEL@
GMAIL.CO
M

677865
3490

09OCT
-04

SA_M
AN

323
83

0

201

20

108

PETE
R

TUK
ER

PTUKER@
GMAIL.CO
M

906786
5423

30JAN05

SA_M
AN

231
31

0

201

20

NEIL

JOSE
PH

NJOSEPH
@GMAIL.
COM

768905
4321

31MA
R-06

SA_M
AN

277
58

0

201

20

109

EMAIL

113

NAN
DITA

MOH
AN

NMOHAN
@GMAIL.
COM

944456
34213

20JUL14

ACCO
UNTA
NT

185
05

0

205

60

110

JANE
TTE

KIN
G

JKING@G
MAIL.CO
M

980989
7645

04MA
R-06

SA_R
EP

231
31

0

145

80

37. Display the name and job_id of employees with their DA amount (DA= 25% of salary).
select first_name,last_name,job_id,salary*.25 as DA from employees;

FIRST_NAME

LAST_NAME

JOB_ID

DA

STEVEN

KING

AD_PRES

16191.75

NEENA

KOCHHAR

AD_VP

12722

LEX

DE HAAN

AD_VP

17348

ALEXANDER

HUNOLD

IT_PROG

6071.75

DAVID

AUSTIN

IT_PROG

5782.75

DIANA

LORENTZ

IT_PROG

4626.25

NANCY

GREENBERG

IT_PROG

4048.25

JOHN

RUSSEL

SA_MAN

8095.75

PETER

TUKER

SA_MAN

5782.75

NEIL

JOSEPH

SA_MAN

6939.5

JANETTE

KING

SA_REP

5782.75

WILLIAM

JOHN

CLERK

3469.5

ANITTA

BAKER

HR_REP

5204.25

NANDITA

MOHAN

ACCOUNTANT

4626.25

SUSAN

VARKEY

FIN_MAN

8674.25

JAIDEN

ALEX

CLERK

1257

